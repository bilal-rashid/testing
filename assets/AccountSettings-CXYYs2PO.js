import{g as W,j as n,o as H,a as L,r as w,Q as q,k as U,l as X,m as Z,d as ee,R as re}from"./index-F0uvlsHd.js";import{c as Y,a as O,e as ae}from"./object-DkfBSX30.js";import{u as v}from"./index.esm-D7_iMr1k.js";import{o as Q}from"./yup-T7nDE8GX.js";import{D as R}from"./Dropdown-CCtc8wHV.js";import{F as C}from"./FormInput-BqRBY1DN.js";import"./world-J20cQgd_.js";import{L as B}from"./LoadingButton-B6IRlRGW.js";import{C as P}from"./Card-Cmn7cKYw.js";import{R as T}from"./Row-9hTZkyBg.js";import{C as j}from"./Col-CeeRnQxB.js";import{c as te}from"./checkPasswordStrength-BI5JvUYW.js";import{P as se}from"./ProgressBar-DZZJPJZT.js";import{F as ne}from"./Form-CTfXWlVo.js";import{N as V}from"./Nav-DqR2o3i6.js";import"./InputGroupContext-C-h8jlw8.js";import"./DataKey-COGXBUcQ.js";import"./listen-DOhMskc_.js";import"./SSRProvider-wOBfTkjq.js";import"./usePrevious-gswdWBZu.js";import"./NavContext-DCzKn6gs.js";import"./useEventCallback-s6m76CRA.js";import"./useCallbackRef-C_9nMhi0.js";import"./mergeOptionsWithPopperConfig-Bgqxz8md.js";import"./useWindow-m91wy-Xa.js";import"./warning-BsyeZTUT.js";import"./contains-xpjwsOxO.js";import"./Button-DEBg3Qkk.js";import"./hook-BcehJP6k.js";import"./extends-CF3RwP-h.js";import"./objectWithoutPropertiesLoose-CAYKN5F1.js";import"./Anchor-BaQl6fCi.js";import"./useMergedRefs-B_kWwTNW.js";import"./NavbarContext-C6pngPXu.js";import"./Button-DEBuu1m2.js";import"./setPrototypeOf-DgZC2w_0.js";import"./clsx-B-dksMZM.js";import"./divWithClassName-B4nvZjDC.js";import"./ElementChildren-DaDnB9c6.js";import"./Nav-CvQLGRrc.js";const $=r=>r.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,""),ie=r=>new Promise((c,o)=>{const f=new FileReader;f.onload=h=>{var u;return c((u=h==null?void 0:h.target)==null?void 0:u.result)},f.onerror=h=>o(h),f.readAsDataURL(r)});var K={},ce=r=>encodeURIComponent(r).replace(/[!'()*]/g,c=>`%${c.charCodeAt(0).toString(16).toUpperCase()}`),G="%[a-f0-9]{2}",z=new RegExp("("+G+")|([^%]+?)","gi"),k=new RegExp("("+G+")+","gi");function M(r,c){try{return[decodeURIComponent(r.join(""))]}catch{}if(r.length===1)return r;c=c||1;var o=r.slice(0,c),f=r.slice(c);return Array.prototype.concat.call([],M(o),M(f))}function le(r){try{return decodeURIComponent(r)}catch{for(var c=r.match(z)||[],o=1;o<c.length;o++)r=M(c,o).join(""),c=r.match(z)||[];return r}}function oe(r){for(var c={"%FE%FF":"��","%FF%FE":"��"},o=k.exec(r);o;){try{c[o[0]]=decodeURIComponent(o[0])}catch{var f=le(o[0]);f!==o[0]&&(c[o[0]]=f)}o=k.exec(r)}c["%C2"]="�";for(var h=Object.keys(c),u=0;u<h.length;u++){var p=h[u];r=r.replace(new RegExp(p,"g"),c[p])}return r}var me=function(r){if(typeof r!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof r+"`");try{return r=r.replace(/\+/g," "),decodeURIComponent(r)}catch{return oe(r)}},de=(r,c)=>{if(!(typeof r=="string"&&typeof c=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(c==="")return[r];const o=r.indexOf(c);return o===-1?[r]:[r.slice(0,o),r.slice(o+c.length)]},fe=function(r,c){for(var o={},f=Object.keys(r),h=Array.isArray(c),u=0;u<f.length;u++){var p=f[u],x=r[p];(h?c.indexOf(p)!==-1:c(p,x,r))&&(o[p]=x)}return o};(function(r){const c=ce,o=me,f=de,h=fe,u=e=>e==null,p=Symbol("encodeFragmentIdentifier");function x(e){switch(e.arrayFormat){case"index":return a=>(s,t)=>{const i=s.length;return t===void 0||e.skipNull&&t===null||e.skipEmptyString&&t===""?s:t===null?[...s,[m(a,e),"[",i,"]"].join("")]:[...s,[m(a,e),"[",m(i,e),"]=",m(t,e)].join("")]};case"bracket":return a=>(s,t)=>t===void 0||e.skipNull&&t===null||e.skipEmptyString&&t===""?s:t===null?[...s,[m(a,e),"[]"].join("")]:[...s,[m(a,e),"[]=",m(t,e)].join("")];case"colon-list-separator":return a=>(s,t)=>t===void 0||e.skipNull&&t===null||e.skipEmptyString&&t===""?s:t===null?[...s,[m(a,e),":list="].join("")]:[...s,[m(a,e),":list=",m(t,e)].join("")];case"comma":case"separator":case"bracket-separator":{const a=e.arrayFormat==="bracket-separator"?"[]=":"=";return s=>(t,i)=>i===void 0||e.skipNull&&i===null||e.skipEmptyString&&i===""?t:(i=i===null?"":i,t.length===0?[[m(s,e),a,m(i,e)].join("")]:[[t,m(i,e)].join(e.arrayFormatSeparator)])}default:return a=>(s,t)=>t===void 0||e.skipNull&&t===null||e.skipEmptyString&&t===""?s:t===null?[...s,m(a,e)]:[...s,[m(a,e),"=",m(t,e)].join("")]}}function y(e){let a;switch(e.arrayFormat){case"index":return(s,t,i)=>{if(a=/\[(\d*)\]$/.exec(s),s=s.replace(/\[\d*\]$/,""),!a){i[s]=t;return}i[s]===void 0&&(i[s]={}),i[s][a[1]]=t};case"bracket":return(s,t,i)=>{if(a=/(\[\])$/.exec(s),s=s.replace(/\[\]$/,""),!a){i[s]=t;return}if(i[s]===void 0){i[s]=[t];return}i[s]=[].concat(i[s],t)};case"colon-list-separator":return(s,t,i)=>{if(a=/(:list)$/.exec(s),s=s.replace(/:list$/,""),!a){i[s]=t;return}if(i[s]===void 0){i[s]=[t];return}i[s]=[].concat(i[s],t)};case"comma":case"separator":return(s,t,i)=>{const d=typeof t=="string"&&t.includes(e.arrayFormatSeparator),l=typeof t=="string"&&!d&&g(t,e).includes(e.arrayFormatSeparator);t=l?g(t,e):t;const b=d||l?t.split(e.arrayFormatSeparator).map(J=>g(J,e)):t===null?t:g(t,e);i[s]=b};case"bracket-separator":return(s,t,i)=>{const d=/(\[\])$/.test(s);if(s=s.replace(/\[\]$/,""),!d){i[s]=t&&g(t,e);return}const l=t===null?[]:t.split(e.arrayFormatSeparator).map(b=>g(b,e));if(i[s]===void 0){i[s]=l;return}i[s]=[].concat(i[s],l)};default:return(s,t,i)=>{if(i[s]===void 0){i[s]=t;return}i[s]=[].concat(i[s],t)}}}function N(e){if(typeof e!="string"||e.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function m(e,a){return a.encode?a.strict?c(e):encodeURIComponent(e):e}function g(e,a){return a.decode?o(e):e}function A(e){return Array.isArray(e)?e.sort():typeof e=="object"?A(Object.keys(e)).sort((a,s)=>Number(a)-Number(s)).map(a=>e[a]):e}function E(e){const a=e.indexOf("#");return a!==-1&&(e=e.slice(0,a)),e}function I(e){let a="";const s=e.indexOf("#");return s!==-1&&(a=e.slice(s)),a}function D(e){e=E(e);const a=e.indexOf("?");return a===-1?"":e.slice(a+1)}function F(e,a){return a.parseNumbers&&!Number.isNaN(Number(e))&&typeof e=="string"&&e.trim()!==""?e=Number(e):a.parseBooleans&&e!==null&&(e.toLowerCase()==="true"||e.toLowerCase()==="false")&&(e=e.toLowerCase()==="true"),e}function S(e,a){a=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},a),N(a.arrayFormatSeparator);const s=y(a),t=Object.create(null);if(typeof e!="string"||(e=e.trim().replace(/^[?#&]/,""),!e))return t;for(const i of e.split("&")){if(i==="")continue;let[d,l]=f(a.decode?i.replace(/\+/g," "):i,"=");l=l===void 0?null:["comma","separator","bracket-separator"].includes(a.arrayFormat)?l:g(l,a),s(g(d,a),l,t)}for(const i of Object.keys(t)){const d=t[i];if(typeof d=="object"&&d!==null)for(const l of Object.keys(d))d[l]=F(d[l],a);else t[i]=F(d,a)}return a.sort===!1?t:(a.sort===!0?Object.keys(t).sort():Object.keys(t).sort(a.sort)).reduce((i,d)=>{const l=t[d];return l&&typeof l=="object"&&!Array.isArray(l)?i[d]=A(l):i[d]=l,i},Object.create(null))}r.extract=D,r.parse=S,r.stringify=(e,a)=>{if(!e)return"";a=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},a),N(a.arrayFormatSeparator);const s=l=>a.skipNull&&u(e[l])||a.skipEmptyString&&e[l]==="",t=x(a),i={};for(const l of Object.keys(e))s(l)||(i[l]=e[l]);const d=Object.keys(i);return a.sort!==!1&&d.sort(a.sort),d.map(l=>{const b=e[l];return b===void 0?"":b===null?m(l,a):Array.isArray(b)?b.length===0&&a.arrayFormat==="bracket-separator"?m(l,a)+"[]":b.reduce(t(l),[]).join("&"):m(l,a)+"="+m(b,a)}).filter(l=>l.length>0).join("&")},r.parseUrl=(e,a)=>{a=Object.assign({decode:!0},a);const[s,t]=f(e,"#");return Object.assign({url:s.split("?")[0]||"",query:S(D(e),a)},a&&a.parseFragmentIdentifier&&t?{fragmentIdentifier:g(t,a)}:{})},r.stringifyUrl=(e,a)=>{a=Object.assign({encode:!0,strict:!0,[p]:!0},a);const s=E(e.url).split("?")[0]||"",t=r.extract(e.url),i=r.parse(t,{sort:!1}),d=Object.assign(i,e.query);let l=r.stringify(d,a);l&&(l=`?${l}`);let b=I(e.url);return e.fragmentIdentifier&&(b=`#${a[p]?m(e.fragmentIdentifier,a):e.fragmentIdentifier}`),`${s}${l}${b}`},r.pick=(e,a,s)=>{s=Object.assign({parseFragmentIdentifier:!0,[p]:!1},s);const{url:t,query:i,fragmentIdentifier:d}=r.parseUrl(e,s);return r.stringifyUrl({url:t,query:h(i,a),fragmentIdentifier:d},s)},r.exclude=(e,a,s)=>{const t=Array.isArray(a)?i=>!a.includes(i):(i,d)=>!a(i,d);return r.pick(e,t,s)}})(K);const ue=W(K),he=r=>{const c=o=>{r.handleImageUpdate(o)};return n.jsx("div",{className:"profile-avatar__cta",children:n.jsxs(R,{autoClose:!1,children:[n.jsx(R.Toggle,{className:"arrow-none rounded-circle btn-sm p-0",id:"dropdown-basic",children:n.jsx("i",{className:"mdi mdi-camera font-16"})}),n.jsx(R.Menu,{children:n.jsx(R.Item,{as:"div",className:"cursor-pointer",children:n.jsxs("label",{htmlFor:"icon-button-file",children:[n.jsx("input",{onChange:c,name:"imageFile",type:"file",accept:"image/*",id:"icon-button-file",style:{display:"none"}}),n.jsx("span",{children:"Upload Picture"})]})})})]})})},pe=()=>{const{accountStore:{currentUser:r,updateCurrentUser:c,updateProfileImage:o}}=L(),[f,h]=w.useState(r==null?void 0:r.imageUrl),[u,p]=w.useState({id:(r==null?void 0:r.id)||"",firstName:(r==null?void 0:r.firstName)||"",lastName:(r==null?void 0:r.lastName)||"",phoneNumber:(r==null?void 0:r.phoneNumber)||"",email:(r==null?void 0:r.email)||""}),x=Y({firstName:O().min(3,"Too Short").required("First Name is Required!"),lastName:O().required("Last Name is Required!"),email:O().required("The email is required").email(),phoneNumber:O().optional()}),y={firstName:u.firstName||"",lastName:u.lastName||"",email:u.email||"",phoneNumber:u.phoneNumber||""},{register:N,handleSubmit:m,reset:g,formState:{isDirty:A,isValid:E,isSubmitting:I}}=v({defaultValues:y,resolver:Q(x)}),D=async e=>{try{await c({...u,...e}),q.success("Profile Updated"),g(),p(a=>({...a,...e}))}catch(a){const s=(a==null?void 0:a.message)||"Update profile failed";q.error(s)}},F=async e=>{var a,s;try{const t=(s=(a=e.target)==null?void 0:a.files)==null?void 0:s[0];await o({ImageFile:t});const d=await ie(t);d&&h(d)}catch(t){const i=(t==null?void 0:t.message)||"Upload image failed";q.error(i)}},S=async()=>{await o({DeleteCurrentImage:!0}),h("")};return w.useEffect(()=>{r&&g({email:r.email,firstName:r.firstName,lastName:r.lastName,phoneNumber:r.phoneNumber||""})},[r]),n.jsx(P,{className:"p-2 pb-5",children:n.jsxs(P.Body,{children:[n.jsx("div",{className:"form-block-title",children:"Edit your account information:"}),n.jsx("div",{children:n.jsxs("div",{className:"profile-avatar profile-avatar--large mb-2",children:[n.jsx("div",{className:"profile-avatar__image-area",children:f||r!=null&&r.imageUrl?n.jsx("img",{src:f||(r==null?void 0:r.imageUrl),id:"profileImage"}):n.jsx("i",{className:"mdi mdi-account-outline"})}),n.jsx(he,{handleImageUpdate:F,handleImageRemove:S}),n.jsxs("div",{className:"profile-avatar__title-group",children:[n.jsxs("div",{className:"profile-avatar__title-group__title text-capitalize",id:"nameDisplay",children:[r==null?void 0:r.firstName," ",r==null?void 0:r.lastName]}),n.jsxs("div",{className:"profile-avatar__title-group__sub text-capitalize",id:"roleDisplay",children:[r==null?void 0:r.roleId," Level User"]})]})]})}),n.jsx("form",{onSubmit:m(D),children:n.jsxs(T,{className:"mt-2",children:[n.jsx(j,{className:"mt-3",xs:12,sm:6,children:n.jsx(C,{label:"First Name",placeholder:"First Name",register:N,name:"firstName"})}),n.jsx(j,{className:"mt-3",xs:12,sm:6,children:n.jsx(C,{label:"Last Name",placeholder:"Last Name",register:N,name:"lastName"})}),n.jsx(j,{className:"mt-3",xs:12,sm:6,children:n.jsx(C,{label:"Email",placeholder:"Email",register:N,name:"email"})}),n.jsx(j,{className:"mt-3",xs:12,sm:6,children:n.jsx(C,{label:"Phone number",placeholder:"Phone number",register:N,name:"phoneNumber"})}),n.jsx(j,{xs:12,className:"d-flex justify-content-end mt-4",children:n.jsx(B,{type:"submit",variant:"primary",disabled:!A||!E||I,loading:I,children:"Save Changes"})})]})})]})})},ge=H(pe),xe=()=>{const{accountStore:r}=L(),{changePassword:c}=r,[o,f]=w.useState(0),h={password:"",newPassword:"",confirmNewPassword:""},u=Y({password:O().required("Current password is required!"),newPassword:O().required("New password is required!"),confirmNewPassword:O().required("Confirm new password is required!").oneOf([ae("newPassword")],"Your passwords do not match!")}),{register:p,handleSubmit:x,reset:y,formState:{isDirty:N,isValid:m,isSubmitting:g},watch:A}=v({defaultValues:h,resolver:Q(u)}),E=A("newPassword"),I=w.useCallback(()=>{const F=te(E,{checkFor:["length","lowerCase","upperCase","number"]}).strength;f(F)},[E]),D=async F=>{try{await c(F),q.success("Password updated"),f(0),y()}catch(S){const e=(S==null?void 0:S.message)||"Password update failed";q.error(e)}};return w.useEffect(()=>{I()},[I]),n.jsx(P,{className:"p-2 pb-5",children:n.jsxs(P.Body,{children:[n.jsx("div",{className:"form-block-title",children:"Update Your Password:"}),n.jsx("form",{onSubmit:x(D),children:n.jsxs(T,{children:[n.jsx(j,{className:"mt-3",xs:12,md:6,children:n.jsx(C,{type:"password",className:"w-100",label:"Current Password",placeholder:"Enter current password",register:p,name:"password"})}),n.jsx(j,{className:"mt-3",xs:0,md:6}),n.jsxs(j,{xs:12,md:6,className:"d-flex flex-column gap-1 mt-3",children:[n.jsx(C,{type:"password",className:"w-100",label:"New Password",placeholder:"Enter new password",register:p,name:"newPassword"}),n.jsx(se,{now:o,className:"progress-sm"})]}),n.jsx(j,{className:"mt-3",xs:12,md:6,children:n.jsx(C,{type:"password",className:"w-100",label:"Confirm New Password",placeholder:"Confirm new password",register:p,name:"confirmNewPassword"})}),n.jsx(j,{xs:12,children:n.jsxs("div",{className:"pt-3",children:[n.jsx("h6",{className:"fs-5 fw-bolder",children:"Password requirements:"}),n.jsx("small",{className:"fw-semibold text-body-tertiary",children:"Ensure that these requirements are met:"}),n.jsxs("ul",{children:[n.jsx("li",{className:"fs-6 text-body-tertiary",children:"Minimum 6 characters long"}),n.jsx("li",{className:"fs-6 text-body-tertiary",children:"At least one lowercase character"}),n.jsx("li",{className:"fs-6 text-body-tertiary",children:"At least one uppercase character"}),n.jsx("li",{className:"fs-6 text-body-tertiary",children:"At least one number"})]})]})}),n.jsx(j,{xs:12,className:"d-flex justify-content-end",children:n.jsx(B,{variant:"primary",disabled:!N||!m||g,loading:g,type:"submit",children:"Save Changes"})})]})})]})})},je=()=>{const{layoutStore:r}=L(),[c,o]=w.useState({darkModeDefault:r.theme===U.LAYOUT_THEME_DARK,pageSizeDefault:r.pageSize}),{register:f,handleSubmit:h,reset:u,formState:{isDirty:p,isValid:x,isSubmitting:y}}=v({defaultValues:c}),N=async m=>{r.changeTheme(m.darkModeDefault?U.LAYOUT_THEME_DARK:U.LAYOUT_THEME_LIGHT),r.changePageSize(m.pageSizeDefault),q.success("Preferences Updated"),o(m)};return n.jsx(P,{className:"p-2 pb-5",children:n.jsxs(P.Body,{children:[n.jsx("div",{className:"form-block-title",children:"Preferences:"}),n.jsxs("form",{onSubmit:h(N),children:[n.jsxs(T,{className:"gap-4",children:[n.jsxs(j,{xs:7,mt:2,children:[n.jsx("p",{className:"fs-5 fw-bolder mb-1",children:"Page Size Default"}),n.jsx(C,{type:"select",className:"w-25",register:f,name:"pageSizeDefault",children:[5,10,25,50,100].map((m,g)=>n.jsx("option",{value:m,className:"fs-6 fw-semibold",children:m},g))})]}),n.jsx(j,{xs:7,children:n.jsx(ne.Switch,{label:"Dark mode",...f("darkModeDefault")})})]}),n.jsx("div",{className:"d-flex justify-content-end",children:n.jsx(B,{type:"submit",variant:"primary",disabled:!p||!x||y,loading:y,children:"Save Changes"})})]})]})})},Ne=H(je),ir=()=>{const{authStore:r}=L(),c=X(),o=Z(),[f]=ee(),h=f.get("practiceId");w.useEffect(()=>{r.setTitle("Profile")},[]);const[u,p]=w.useState("user-info");return re.useEffect(()=>{if(!o.search)return;const x=ue.parse(o.search);x.tab&&p(x.tab)},[o]),n.jsx("div",{className:"pt-2 pb-4",children:n.jsxs(T,{children:[n.jsx(j,{xxl:2,xl:3,lg:4,children:n.jsx(P,{children:n.jsx(P.Body,{className:"px-2",children:n.jsx(V,{variant:"pills",children:_.map(({id:x,name:y,icon:N})=>n.jsx(V.Item,{className:"w-100",children:n.jsxs(V.Link,{active:u===$(y),className:"d-flex items-center",onClick:()=>c(`/profile?tab=${$(y)}&practiceId=${h}`),children:[n.jsx("i",{className:`${N} me-1`}),n.jsx("span",{className:"",children:y})]})},x))})})})}),n.jsxs(j,{xxl:10,xl:9,lg:8,children:[u===$(_[0].name)&&n.jsx(ge,{}),u===$(_[1].name)&&n.jsx(Ne,{}),u===$(_[2].name)&&n.jsx(xe,{})]})]})})},_=[{id:1,name:"User Info",icon:"mdi mdi-account-circle"},{id:2,name:"Preferences",icon:"mdi mdi-account-edit"},{id:3,name:"Password",icon:"mdi mdi-lifebuoy"}];export{ir as default};
