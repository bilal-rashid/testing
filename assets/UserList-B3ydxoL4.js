import{j as e,o as P,a as L,r as A,Q as y}from"./index-F0uvlsHd.js";import{C as H}from"./ClientTable-CL6XX6Gc.js";import{c as T,a as n,b as J}from"./object-DkfBSX30.js";import{C as W,u as $}from"./index.esm-D7_iMr1k.js";import{o as z}from"./yup-T7nDE8GX.js";import{F as o}from"./FormInput-BqRBY1DN.js";import"./world-J20cQgd_.js";import{S as X}from"./react-select.esm-TmlbU86R.js";import{F}from"./Form-CTfXWlVo.js";import{L as E}from"./LoadingButton-B6IRlRGW.js";import{M as D,u as K,g as Z}from"./index-BB-SF9mV.js";import{R as G}from"./Row-9hTZkyBg.js";import{C as i}from"./Col-CeeRnQxB.js";import{S as V}from"./Stack-B2DR9NGx.js";import{B as R}from"./Button-DEBuu1m2.js";import{c as Y}from"./clsx-B-dksMZM.js";import{A as _}from"./Avatar-CLVYePaJ.js";import{g as O}from"./getInitials-fn6u8gr9.js";import{B as ee}from"./Badge-DxtUJ9I1.js";import{P as se}from"./PageLayout-Cd-4jQXh.js";import{C as k}from"./Card-Cmn7cKYw.js";import"./simplebar-react.esm-Cne10Fc6.js";import"./index-DERQo0GJ.js";import"./InputGroupContext-C-h8jlw8.js";import"./setPrototypeOf-DgZC2w_0.js";import"./warning-BsyeZTUT.js";import"./objectWithoutPropertiesLoose-CAYKN5F1.js";import"./extends-CF3RwP-h.js";import"./ElementChildren-DaDnB9c6.js";import"./Modal-C5mqPxj_.js";import"./listen-DOhMskc_.js";import"./useCallbackRef-C_9nMhi0.js";import"./useEventCallback-s6m76CRA.js";import"./useMergedRefs-B_kWwTNW.js";import"./hasClass-CJ0GaH7t.js";import"./useWindow-m91wy-Xa.js";import"./NoopTransition-DmAqiXSQ.js";import"./TransitionWrapper-Cb4OEx4M.js";import"./AbstractModalHeader-fWu4g0rU.js";import"./contains-xpjwsOxO.js";import"./usePrevious-gswdWBZu.js";import"./DataKey-COGXBUcQ.js";import"./CloseButton-BKCUVlX4.js";import"./Fade-Do2bjijw.js";import"./divWithClassName-B4nvZjDC.js";import"./Button-DEBg3Qkk.js";const Q=({name:a,label:t,id:s,className:l,containerClass:m,placeholder:x,helpText:d,options:p,errors:h,control:C,required:j=!1,defaultValue:U,isMulti:b=!1,onChange:c,...w})=>e.jsx(W,{name:a,control:C,defaultValue:U,render:({field:N,fieldState:S})=>{var v;return e.jsxs(F.Group,{className:m??"",children:[t&&e.jsx(F.Label,{children:t}),e.jsx(X,{...N,id:s,className:l,classNamePrefix:"react-select",options:p,placeholder:x,isMulti:b,value:b?p.filter(r=>(N.value||[]).includes(r.value)):p.find(r=>r.value===N.value)||null,onChange:r=>{const f=b?r.map(I=>I.value):(r==null?void 0:r.value)||"";N.onChange(f),c&&c(r)},...w}),d&&e.jsx(F.Text,{id:`${a}-help`,muted:!0,children:d}),h&&h[a]&&e.jsx(F.Control.Feedback,{type:"invalid",children:(v=h[a])==null?void 0:v.message})]})}}),ae=({show:a,onHide:t})=>{const{usersStore:s,practiceStore:l}=L(),{createAppUser:m,loading:x}=s,{practices:d}=l,p=A.useMemo(()=>({id:"",firstName:"",lastName:"",email:"",password:"Password123!",phoneNumber:"",roleId:"basic"}),[]),h=T({firstName:n().required("The first name is required"),lastName:n().required("The last name is required"),email:n().required().email(),password:n().required(),phoneNumber:n(),roleId:n().oneOf(["admin","editor","basic"])}),{reset:C,register:j,handleSubmit:U,control:b,formState:{isDirty:c,isValid:w,isSubmitting:N}}=$({defaultValues:p,resolver:z(h)}),S=()=>{C(),t()},v=async r=>{try{await m(r),y.success("User Added Successfully!"),S()}catch(f){const I=f==null?void 0:f.message;y.error(I)}};return e.jsx(D,{show:a,onHide:S,headerTitle:"Add User",children:e.jsxs("form",{onSubmit:U(r=>v({...p,...r})),children:[e.jsxs(G,{className:"mt-1",children:[e.jsx(i,{className:"mt-2",xs:12,sm:6,children:e.jsx(o,{type:"text",label:"First Name",placeholder:"First Name",register:j,name:"firstName"})}),e.jsx(i,{className:"mt-2",xs:12,sm:6,children:e.jsx(o,{type:"text",label:"Last Name",placeholder:"Last Name",register:j,name:"lastName"})}),e.jsx(i,{className:"mt-2",xs:12,sm:6,children:e.jsx(o,{type:"text",label:"Email",placeholder:"user@email.com",register:j,name:"email"})}),e.jsx(i,{className:"mt-2",xs:12,sm:6,children:e.jsx(o,{type:"text",label:"Phone Number",placeholder:"Phone Number",register:j,name:"phoneNumber"})}),e.jsx(i,{className:"mt-2",xs:12,sm:6,children:e.jsx(o,{type:"text",label:"Password",placeholder:"Password",register:j,name:"password"})}),e.jsxs(i,{className:"mt-2",xs:12,children:[e.jsx("h6",{className:"fs-6 mb-1",children:"Role"}),e.jsx(V,{direction:"horizontal",gap:1,children:["admin","editor","basic"].map(r=>e.jsx(o,{type:"radio",value:r,label:r,register:j,name:"roleId",className:"text-capitalize"},r))})]}),e.jsx(i,{className:"mt-2",xs:12,sm:6,children:e.jsx(Q,{name:"practiceIds",label:"Choose practice",control:b,isMulti:!0,options:d.map(r=>({value:r.id,label:r.name}))})})]}),e.jsxs("div",{className:"d-flex justify-content-end mt-4 gap-2",children:[e.jsx(R,{variant:"light",onClick:()=>S(),children:"Cancel"}),e.jsx(E,{type:"submit",variant:"primary",disabled:!c||!w||N,loading:N||x,children:"Save"})]})]})})},re=P(ae),te=({show:a,onHide:t,data:s})=>{const{usersStore:l,practiceStore:m}=L(),{updateAppUser:x,loading:d,loadingDelete:p,deleteAppUser:h}=l,{practices:C}=m,j=A.useMemo(()=>({id:s.id,firstName:s.firstName,lastName:s.lastName,email:s.email,phoneNumber:s.phoneNumber,isActive:s.isActive,roleId:s.roleId,imageUrl:s.imageUrl,createdOn:s.createdOn,practiceIds:s.practiceIds}),[s]),U=T({firstName:n().required("The first name is required"),lastName:n().required("The last name is required"),email:n().required().email(),phoneNumner:n(),roleId:n().oneOf(["admin","editor","basic"]),isActive:J()}),{reset:b,register:c,handleSubmit:w,control:N,formState:{isDirty:S,isValid:v,isSubmitting:r}}=$({defaultValues:j,resolver:z(U)}),f=async u=>{try{await h(u),y.error("User Deleted Successfully!"),t()}catch(g){const q=g==null?void 0:g.message;y.error(q)}},I=async u=>{try{await x(u),y.info("User Edited Successfully!"),t(),b()}catch(g){const q=g==null?void 0:g.message;y.error(q)}},M=s.roleId==="root";return e.jsx(D,{show:a,onHide:t,headerTitle:"Edit User",children:e.jsxs("form",{onSubmit:w(I),children:[e.jsxs(G,{className:"mt-1",children:[!M&&e.jsx(i,{className:"mt-2",xs:12,children:e.jsx(o,{type:"checkbox",label:"Is Active",register:c,name:"isActive"})}),e.jsx(i,{className:"mt-2",xs:12,sm:6,children:e.jsx(o,{type:"text",label:"First Name",placeholder:"First Name",register:c,name:"firstName"})}),e.jsx(i,{className:"mt-2",xs:12,sm:6,children:e.jsx(o,{type:"text",label:"Last Name",placeholder:"Last Name",register:c,name:"lastName"})}),e.jsx(i,{className:"mt-2",xs:12,sm:6,children:e.jsx(o,{type:"text",label:"Email",placeholder:"user@email.com",register:c,name:"email"})}),e.jsx(i,{className:"mt-2",xs:12,sm:6,children:e.jsx(o,{type:"text",label:"Phone Number",placeholder:"Phone Number",register:c,name:"phoneNumber"})}),!M&&e.jsxs(i,{className:"mt-2",xs:12,children:[e.jsx("h6",{className:"fs-6 mb-1",children:"Role"}),e.jsx(V,{direction:"horizontal",gap:1,children:["admin","editor","basic"].map(u=>e.jsx(o,{type:"radio",value:u,label:u,register:c,name:"roleId",className:"text-capitalize"},u))})]}),e.jsx(i,{className:"mt-2",xs:12,sm:6,children:e.jsx(Q,{name:"practiceIds",label:"Choose practice",control:N,isMulti:!0,options:C.map(u=>({value:u.id,label:u.name}))})})]}),e.jsxs("div",{className:Y("d-flex",M?"justify-content-end":"justify-content-between","mt-4"),children:[!M&&e.jsx(E,{variant:"danger",loading:p,onClick:()=>f(s.id),children:"Delete"}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(R,{variant:"light",onClick:t,children:"Cancel"}),e.jsx(E,{type:"submit",variant:"primary",disabled:!S||!v||r,loading:r||d,children:"Save"})]})]})]})})},ie=P(te),B=[{header:"Name",enableSorting:!0,accessorFn:a=>a.firstName+" "+a.lastName,cell:({row:a})=>{const{firstName:t,lastName:s,imageUrl:l}=a.original;return e.jsxs("div",{className:"table-profile-component",children:[e.jsx(_,{src:l,text:O(t,s)}),e.jsx("strong",{children:t+" "+s})]})}},{header:"Role",enableSorting:!0,accessorKey:"roleId",enableGlobalFilter:!1,cell:({getValue:a})=>{var s;const t={root:"success",admin:"success",editor:"info",basic:"info"};return e.jsx("h4",{children:e.jsx(ee,{bg:t[(s=a())==null?void 0:s.toLowerCase()],className:"text-light text-capitalize",children:a()})})}},{header:"Email",enableSorting:!0,accessorKey:"email"},{header:"Active",enableSorting:!0,accessorKey:"isActive",enableGlobalFilter:!1,cell:({getValue:a})=>{var t,s;return e.jsx("strong",{className:Y(((t=a())==null?void 0:t.toString().toLowerCase())==="true"?"text-success":"text-danger","text-capitalize"),children:((s=a())==null?void 0:s.toString())=="true"?"Yes":"No"})}},{header:"",accessorKey:"edit",cell:({row:a})=>{const{id:t}=a.original,{accountStore:s}=L(),{currentUser:l}=s,{show:m,onShow:x,onHide:d}=K();return e.jsxs(e.Fragment,{children:[t!=(l==null?void 0:l.id)?e.jsx("button",{className:"btn btn-soft-primary rounded-pill",onClick:x,children:"Edit"}):"N/A(You)",m&&e.jsx(ie,{show:m,onHide:d,data:a.original})]})}}],le=()=>{const{usersStore:a}=L(),{loadAppUsers:t,appUsersSorted:s,loadingInitial:l}=a,{show:m,onShow:x,onHide:d}=K(),p=A.useMemo(()=>s,[s]),h=A.useMemo(()=>B,[B]);return A.useEffect(()=>{t()},[t]),e.jsxs(se,{title:"Users",action:e.jsx(R,{variant:"primary",onClick:x,children:"New User"}),children:[m&&e.jsx(re,{show:m,onHide:d}),e.jsx(k,{className:"pt-2",children:e.jsx(k.Body,{children:e.jsx(H,{data:p,columns:h,getCoreRowModel:Z(),isLoading:l,filterFieldPlaceholder:"Search users..."})})}),e.jsx("div",{className:"mb-2",children:e.jsx("small",{children:"Client-side pagination with sorting & filtering"})})]})},Oe=P(le);export{Oe as default};
